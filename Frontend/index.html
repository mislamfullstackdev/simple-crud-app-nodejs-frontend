<!DOCTYPE html>
<html>
  <head>
    <title>Book CRUD Application</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0/css/bootstrap.min.css">
  </head>
<body>
  <h1>Book CRUD Application</h1>

  <!-- Create a new book form -->
  <h2>Create a New Book</h2>
  <form id="createBookForm">
    <label for="name">Name:</label>
    <input type="text" id="name" required>
    <br>
    <label for="author">Author:</label>
    <input type="text" id="author" required>
    <br>
    <label for="publish_date">Publish Date:</label>
    <input type="date" id="publish_date" required>
    <br>
    <button type="submit">Create</button>
  </form>

  <!-- Book list -->
  <h2>Book List</h2>
  <ul id="bookList" class="list-group"></ul>

  <script>
    // Function to fetch and display the list of books
    function displayBooks() {
      fetch('http://localhost:3000/books/')
        .then(response => response.json())
        .then(data => {
          const bookList = document.getElementById('bookList');
          bookList.innerHTML = '';

          data.forEach(book => {
            const li = document.createElement('li');
            li.classList.add('list-group-item');
            li.innerHTML = `${book.name} by ${book.author} (Published on ${book.publish_date})`;
            bookList.appendChild(li);
          });
        })
        .catch(error => console.error('Error fetching books:', error));
    }

    // Function to create a new book
    const createBookForm = document.getElementById('createBookForm');
    createBookForm.addEventListener('submit', event => {
      event.preventDefault();

      const name = document.getElementById('name').value;
      const author = document.getElementById('author').value;
      const publish_date = document.getElementById('publish_date').value;

      fetch('http://localhost:3000/books/', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, author, publish_date })
      })
      .then(() => {
        displayBooks();
        createBookForm.reset();
      })
      .catch(error => console.error('Error creating book:', error));
    });

    // Initial book list display
    displayBooks();
  </script>
</body>
</html>
